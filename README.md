# Предсказание стоимости квартир
## Постановка задачи
Обучить модель линейной регрессии на данных о жилье в Калифорнии в 1990 году.
Для оценки качества моделей будут использованы RMSE, MAE и R2.

## Особенности проекта:
    1. Построение 2х моделей: с категориальными признаками и без них для последующего сравнения метрик;
    2. Использование Apache Spark для работы с данными.
    
## Этапы работы:
### Загрузка данных
Для загрузки и первичной обработки данных была использованна локальная сессия Spark

### Предобработка данных
В процессе предобработки отсутствующие значения в столбце total_bedrooms были заменены на медиану, в остальном данные не имели искажений, влияющих на метрики.

### Анализ
Удаление столбца с данными о близости жилья к океану негативно сказалось на метриках модели, что подтверждает гипотезу о том, что существует явная зависимость цены от этого показателя.

### Моделирование
Был составлен пайплайн для работы с признаками, в него вошли OneHotEncoder для кат. признака и StandartScaler для числовых

В результате кросс-валидации была выбрана модель Random forest с параметрами:
- numTrees: 50
- maxDepth: 15

Итоговые метрики модели:
- **RMSE**: 51363.522028492414
- **R^2**: 0.8093207838702373
- **MAE**: 35280.34973507946
